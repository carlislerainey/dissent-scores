{
  "hash": "2590002af5679a6a9c5141f83e994609",
  "result": {
    "markdown": "---\ntitle: \"Fill the Country-Years with Counts\"\nfreeze: true\n---\n\n\nFirst, load the empty country-years to fill with the count data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(lubridate)\n\n# load data set of country-years to fill\ncountry_year <-  read_csv(\"output/empty-country-years.csv\") %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,775\nColumns: 3\n$ year      <dbl> 1990, 1990, 1990, 1990, 1990, 1990, 1990, 1990, 1990, 1990, …\n$ ccode     <dbl> 2, 20, 31, 40, 41, 42, 51, 52, 53, 54, 55, 56, 57, 58, 60, 7…\n$ idea_code <chr> \"USA\", \"CAN\", \"BHM\", \"CUB\", \"HAI\", \"DOM\", \"JAM\", \"TRI\", \"BAR…\n```\n:::\n:::\n\n\nSecond, load the dissent events data and count the events for each country-year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the dissent events and count for each country year\ndissent_events <- read_csv(\"output/idea-dissent-events.csv\") %>%\n  mutate(year = year(date)) %>%\n  select(idea_code = where_idea, year) %>%\n  group_by(idea_code, year) %>%\n  summarize(n_dissent_events = n()) %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,977\nColumns: 3\nGroups: idea_code [203]\n$ idea_code        <chr> \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG…\n$ year             <dbl> 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998,…\n$ n_dissent_events <int> 49, 44, 47, 47, 40, 32, 31, 30, 9, 10, 4, 68, 39, 55,…\n```\n:::\n:::\n\n\nThird, load all events and count the events for each country-year.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load all events and count for each country year\nall_events <- read_csv(\"output/idea-all-events.csv\") %>%\n  separate(EVENTDAT, c(\"date\", \"time\"), sep = \" \", fill = \"right\") %>%\n  mutate(year = year(mdy(date))) %>%\n  select(idea_code = PLACE, year) %>%\n  group_by(idea_code, year) %>%\n  summarize(n_events = n()) %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 4,228\nColumns: 3\nGroups: idea_code [369]\n$ idea_code <chr> \"ACI\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG\", \"AFG…\n$ year      <dbl> 1996, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, …\n$ n_events  <int> 1, 489, 605, 1298, 957, 711, 849, 1572, 1268, 1249, 868, 763…\n```\n:::\n:::\n\n\nFinally, join the counts with the country-year data set and replace NAs with zeros.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncounts <- country_year |>\n  left_join(dissent_events) |>\n  left_join(all_events) %>%\n  # fill missing values with zero (i.e., no events)\n  mutate(n_events = ifelse(is.na(n_events), 0, n_events)) %>%\n  mutate(n_dissent_events = ifelse(is.na(n_dissent_events), 0, n_dissent_events)) %>%\n  write_csv(\"output/idea-counts.csv\") %>%\n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 2,775\nColumns: 5\n$ year             <dbl> 1990, 1990, 1990, 1990, 1990, 1990, 1990, 1990, 1990,…\n$ ccode            <dbl> 2, 20, 31, 40, 41, 42, 51, 52, 53, 54, 55, 56, 57, 58…\n$ idea_code        <chr> \"USA\", \"CAN\", \"BHM\", \"CUB\", \"HAI\", \"DOM\", \"JAM\", \"TRI…\n$ n_dissent_events <dbl> 118, 12, 0, 6, 5, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 9, 1,…\n$ n_events         <dbl> 135537, 7781, 22, 979, 310, 121, 140, 220, 131, 6, 1,…\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}